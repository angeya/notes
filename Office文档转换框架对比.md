## 框架对比

### Ice-blue Spire (8.3.6)

收费。有内存问题。

| 文件名             | 文件大小 | 页数 | 耗时ms  | 还原度 | 其他                                            |
| ------------------ | -------- | ---- | ------- | ------ | ----------------------------------------------- |
| 简单demo.docx      | 26k      | 4    | 8,440   | 99%    |                                                 |
| word格式的表格.doc | 93       | 2    | 774     | 99%    | 本地近乎完美。linux下格式会乱，个别字几乎被遮挡 |
| 业务说明.docx      | 19M      | 107  | 144,779 | 95%    | 现场会oom，本地没有oom，但是出现idea黑屏        |
| 工程实施说明.docx  | 22M      | 17   | 45,885  | 95%    |                                                 |
| 用户手册.docx      | 82M      | 265  | 无穷大  | 0      | 图片多，处理两三分钟后，oom                     |



### Asponse

收费。收费软件中算最好了。

价格 （永久）：
**开发人员：**1679 美元：1 个开发人员和 1 个部署位置。5037 美元：1 个开发人员和无限的部署位置。33580 美元：1 个开发人员和 50 个商业部署

**网站：**8395 美元：最多 10 个开发人员和 10 个部署位置。23506 美元：最多 10 名开发人员和无限的部署位置。83950 美元：最多 10 名开发人员和 250 个商业部署

**计量：**1999 美元/月

| 文件名             | 文件大小 | 页数 | 耗时ms | 还原度 | 其他               |
| ------------------ | -------- | ---- | ------ | ------ | ------------------ |
| 简单demo.docx      | 26k      | 4    | 2,100  | 99%    |                    |
| word格式的表格.doc | 93       | 2    | 8,949  | 95%    | 出现不该换行的地方 |
| 业务说明.docx      | 19M      | 107  | 21,160 | 95%    |                    |
| 工程实施说明.docx  | 22M      | 17   | 5,434  | 90%    | 页面会变成22页     |
| 用户手册.docx      | 82M      | 265  | 43,469 | 90%    | 页眉位置向左偏移   |



### Doc4j

开源。免费开箱即用的框架中算是很出色了。

| 文件名             | 文件大小 | 页数 | 耗时ms  | 还原度 | 其他                               |
| ------------------ | -------- | ---- | ------- | ------ | ---------------------------------- |
| 简单demo.docx      | 26k      | 4    | 13,924  | 85%    | 部分字体缺失                       |
| word格式的表格.doc | 93       | 2    | 无穷大  | 0      | 被认为是Excel表格，报错了          |
| 业务说明.docx      | 19M      | 107  | 48,360  | 70%    | 部分字体缺失(应该不难解决)         |
| 工程实施说明.docx  | 22M      | 17   | 25,259  | 80%    | 间隔变小 14页                      |
| 用户手册.docx      | 82M      | 265  | 148,573 | 70%    | 字体缺失，标题有重叠。页眉位置不对 |



### OpenOffice / LibreOffice +jodconverter

Apache旗下开源组件。(不支持docx，pptx等格式，但是换了后缀名不影响转换)

| 文件名             | 文件大小 | 页数 | 耗时ms | 还原度 | 其他                           |
| ------------------ | -------- | ---- | ------ | ------ | ------------------------------ |
| 简单demo.docx      | 26k      | 4    | 1,824  | 90%    | 个别字重叠                     |
| word格式的表格.doc | 93       | 2    | 774    | 100%   | 近乎完美                       |
| 业务说明.docx      | 19M      | 107  | 19,273 | 95%    |                                |
| 工程实施说明.docx  | 22M      | 17   | 3,259  | 95%    |                                |
| 用户手册.docx      | 82M      | 265  | 39,262 | 90%    | 表格中个别字间距变大，偶现换行 |



### KKFileView

安装包很大，1-2G。安装相对麻烦，在本地运行上传文件会被加密，转换乱码了。底层使用OpenOffice/LibreOffice。



### Poi

Apache旗下开源框架。

poi虽然很强大，但用起来是最痛苦的，用的组件多，各种版本冲突，各种缺少组件。而且转换效果不好。





## 总结

从还原度来看，Spire、Aspose、OpenOffice都是可以使用的。

**Spire(8.3.6)：**整体还原度不错，但是时间和内存开销很大。

**Aspose：**没什么问题，但是售价较高。

**OpenOffice：**没有什么明显问题，而且免费。但是不能开箱即用，需要安装OpenOffice或者LibreOffice。

综上，如果不付费的话，可以使用OpenOffice，或者和Spire一起使用。付费可以使用Aspose，Spire新版性能和还原度还未来得及评测。